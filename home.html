<html>
    <head>
        <title>Homepage</title>
        <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="./style/master.css">

        <style>
            #point-submission {
                display: flex;
                align-items: flex-start;
                justify-content: center;
            }
            .objective {
                display: flex;
                align-items: baseline;
                width: 100%;
            }
            .objective > input {
                text-align: start;
                width: 10%;
            }
            
            .objective > label {
                width: 85%;
                padding-left: 10px;
            }
            .point-divider {
                font-size: 18pt;
                font-weight: 600;
                margin: 10px;
                margin-top: 20px;
            }
            button {
                width: 100%;
                height: 40px;
                background-color: var(--secondary-clr);
                border: solid var(--secondary-clr) 0;
                color: whitesmoke;
                font-weight: 600;
                letter-spacing: 1px;
                border-radius: 5px;
                margin-top: 8px;
                cursor: pointer;
                margin: 20px 0 0 0;
            }
            
            #progresstube {
                background: var(--secondary-clr);
                border-radius: 13px;
                height: 20px;
                width: 100%;
                padding: 3px;
            }

            .label-line-silver {
                float: right;
                background: silver;
                height:30px;
                width:4px;
                align: center;
                /*margin-left: 2px;*/
            }

            .label-line-gold {
                float: right;
                background: gold;
                height:30px;
                width:4px;
                align: center;
                /*margin-left: 2px;*/
            }

            .label-line-platinum {
                float: right;
                background: paleturquoise;
                height:30px;
                width:4px;
                align: center;
                /*margin-left: 2px;*/
            }

            .bar-step {
                position:absolute;
                margin-top:-8px;
                font-size:12px;
            }

            @media screen and (max-width: 738px) 
            {
                #welcome > *{
                    display: none;
                }
            }
            
            @media screen and (max-width: 480px) 
            {
                #point-submission{
                    flex-direction: column;
                }
                #week-selection{
                    order: 0;
                }
                #stats{
                    order: 1;
                }
                #points{
                    order: 2;
                }
                .box {
                    width: 100%;
                }
            }
            
            @media screen and (max-width: 1200px) 
            {
                #point-submission{
                    flex-direction: row;
                    flex-wrap: wrap;
                }
                #week-selection{
                    order: 0;
                }
                #stats{
                    order: 1;
                }
                #points{
                    order: 2;
                }
            }

            #progresswater {
                position:inherit;
                content: '';
                display: block;
                background: var(--main-clr);
                width: 50%; /* THIS IS THE ACTUAL PROGRESS */
                height: 100%;
                border-radius: 9px;               
            }

            input[type=checkbox]
            {
                transform:scale(1.5);
            }/*
            input[type=number]::-webkit-inner-spin-button,
            input[type=number]::-webkit-outer-spin-button {
                opacity: 1;
            }*/
        </style>
    </head>
    <body>
        <nav>
             <!-- This is the navigation bar -->
            <div class="navButton"> 
                <a href="./index.html">About</a>
            </div>

            <div class="navButton"> 
                <a href="./home.html">Home</a>
            </div>
            
            <div class="navButton">
                <a href="./login.html">Login</a>
            </div>
            <div id="welcome" style="position: absolute; right: 10; top: 2">
                <h5 style="padding: 11 0; color: white" >Hello, Name Here</h5>
            </div>
            
        </nav>

        <div id="point-submission">

            <form id="week-selection" class="box skinny" >
                <h2>Spring 2019</h2>
                <div style="text-align-last: left; padding: 20px 5px">
                    Week of:
                </div>
                <select>
                    <option value="1">1/14/2019</option>
                    <option value="2">1/21/2019</option>
                    <option value="3">1/28/2019</option>
                    <option value="4">2/4/2019</option>
                    <option value="5">2/11/2019</option>
                    <option value="6">2/18/2019</option>
                    <option value="7">3/4/2019</option>
                    <option value="8">3/11/2019</option>
                    <option value="9">3/18/2019</option>
                    <option value="10">3/25/2019</option>
                    <option value="11">4/1/2019</option>
                    <option value="12">4/8/2019</option>
                    <option value="13">4/15/2019</option>
                    <option value="14">4/22/2019</option>
                    <option value="15">4/29/2019</option>
                </select>
                <button type="submit" style="cursor:pointer">
                    Show
                </button>
            </form>

            <form id="points"  class="box" method="POST">
                <img  style="width: 100%; padding: 20px 5px"  src="./resources\transparent-logo.png">
                <h2>Point Submission for Week <span id="week-num">1</span></h2>

                <div class="point-divider">
                    Earn 1 Point Each
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="meditationClass">
                    <label>Participate in Center for Faith and Vocation guided meditation class</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="fruits">
                    <label>Eat 5 servings of fruits/vegetables in one day</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="noSugaryDrinks">
                    <label>Avoid all sugar-sweetened beverages for one day</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="fitnessClass">
                    <label>Participate in an HRC fitness class</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="homeLunch">
                    <label>Pack a healthy lunch from home</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="parkFar">
                    <label>Park far away from work/store and walk</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="sleep">
                    <label>Sleep 7 and a half hours or more in one night</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="upstairsBathroom">
                    <label>Use the restroom on different floor or building from your office</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="seatbelt">
                    <label>Wear your seat belt whenever in the car or bike helmet when biking</label>
                </div>

                <div class="point-divider">
                    Earn 5 Points Each
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="medications">
                    <label>Take prescribed medications for an entire week</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="snackForOffice">
                    <label>Contribute a healthy meal/snack for office pitch in</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0"name="increaseSteps">
                    <label>Increase your weekly step count average by 1000 steps</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="exercise">
                    <label>Obtain 150 minutes of exercise in one week</label>
                </div>

                <div class="point-divider">
                    Earn 25 Points Each
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="lunchAndLearn">
                    <label> Attend a Healthy Horizons lunch and learn</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="read">
                    <label> Read an entire novel for stress relief</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" placeholder="0" name="healthyBlog">
                    <label> Register for Healthier BU Blog</label>
                </div>

                <div class="point-divider">
                    Earn 50 Points Each
                </div>
                <div class="objective">
                    <input type="number" min="0" max="1" placeholder="0" name="annualConsult">
                    <label> Complete annual wellness consult with Healthy Horizons</label>
                </div>
                <div class="objective">
                    <input type="number" min="0" max="1" placeholder="0" name="annualPhysical">
                    <label> Complete annual physical with your Primary Care Provider</label>
                </div>
                <button style="cursor:pointer">
                    Submit
                </button>
            </form>
            

            <form class="box skinny" id="stats">
                <h2>Stats</h2>
                <p>
                    Progress to Platinum:
                </p>
                <div id="progresstube">
                    <div class="bar-step" style="left: 18%">
                        <!-- <div class="label-line-silver"></div>
                        <p>SILVER</p> -->
                    </div>
                    <div class="bar-step" style="left: 48%">
                        <!-- <div class="label-line-gold"></div>
                        <p>GOLD</p> -->
                    </div>
                    <div class="bar-step" style="left: 70%">
                        <!-- <div class="label-line-platinum"></div>
                        <p>PLATINUM</p> -->
                    </div>
                    <div id="progresswater">

                    </div>
                </div>
            </form>

        </div>
        <script src="script/data.js" type="text/javascript"></script>
        <script>
        
            // Update week
            const weekForm = document.querySelector('#week-selection')
            weekForm.addEventListener('submit', (event) => {
                event.preventDefault()
                const week = weekForm.querySelector('select').value
                const weekNum = document.querySelector('#week-num')
                weekNum.textContent = week
                fillFormForWeek(week)
            })

            // Populate the form with data
            let data = getLocalFormData()
            const form = document.querySelector('#points')
            
            // Submit points
            const pointsForm = document.querySelector('#points')
            pointsForm.addEventListener('submit', (event) => {
                event.preventDefault()
                var conf = confirm("Are you sure that you'd like to submit all points for this semester?")
                if(conf == true){
                    // Make new post request and save data from form
                    var xhr = new XMLHttpRequest()
                    xhr.open("POST", "home.html", true)
                    xhr.setRequestHeader('Content-type', 'application/json;charset=UTF-8')
                    let obj = {jsondata: data}
                    console.log(JSON.stringify(obj))
                    xhr.send(JSON.stringify(obj))
                }
            })

            function fillFormForWeek(week) {
                for (var objective in data[week - 1]) {
                    if (data[week - 1].hasOwnProperty(objective)) {
                        form.querySelector("input[name='" + objective +"']").value = data[week - 1][objective]
                    }
                }
            }

            const week = document.querySelector('#week-num').textContent
            fillFormForWeek(week)
            

            function saveData() {
                document.querySelector('#week-num').textContent
                for (var objective in data[week - 1]) {
                    if (data[week - 1].hasOwnProperty(objective)) {
                        data[week - 1][objective] = form.querySelector("input[name='" + objective +"']").value
                    }
                }
                window.localStorage.setItem("formData", JSON.stringify(data))
            }

            function saveOnTimeout() {
                setTimeout(function () {
                    saveData()
                    saveOnTimeout()
                }, 2000)
            }

            saveOnTimeout()

        </script>
    </body>
</html>